<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Test Favorite Merchants</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
<div class="max-w-2xl mx-auto bg-white rounded-lg shadow-lg p-6">
<h1 class="text-2xl font-bold mb-6 text-gray-800">Test Favorite Merchants Feature</h1>

<div class="space-y-4">
<div class="border-b pb-4">
<h2 class="font-semibold text-lg mb-2">1. Seed Receipt History</h2>
<p class="text-sm text-gray-600 mb-3">This will create sample payment history for testing</p>
<button id="seedHistory" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
Seed Receipt History (5 payments)
</button>
</div>

<div class="border-b pb-4">
<h2 class="font-semibold text-lg mb-2">2. View Current Data</h2>
<button id="viewData" class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700">
View All Data
</button>
<pre id="dataDisplay" class="mt-3 bg-gray-50 p-3 rounded text-xs overflow-auto max-h-96 hidden"></pre>
</div>

<div class="border-b pb-4">
<h2 class="font-semibold text-lg mb-2">3. Clear All Data</h2>
<button id="clearData" class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700">
Clear All (Reset)
</button>
</div>

<div>
<h2 class="font-semibold text-lg mb-2">4. Test Feature</h2>
<p class="text-sm text-gray-600 mb-3">After seeding, go to home.html to see favorite merchants</p>
<a href="home.html" class="inline-block bg-purple-600 text-white px-4 py-2 rounded hover:bg-purple-700">
Go to ATM Home
</a>
</div>
</div>

<div id="status" class="mt-6 p-4 rounded hidden"></div>
</div>

<script>
const showStatus = (message, isError = false) => {
  const status = document.getElementById('status');
  status.textContent = message;
  status.className = `mt-6 p-4 rounded ${isError ? 'bg-red-100 text-red-800' : 'bg-green-100 text-green-800'}`;
  status.classList.remove('hidden');
};

document.getElementById('seedHistory').addEventListener('click', () => {
  const sampleReceipts = [
    {
      provider: 'SP Services',
      docType: 'Bill',
      amount: 'S$66.20',
      refNumber: '987654321',
      savedAt: new Date(Date.now() - 3 * 24 * 60 * 60 * 1000).toISOString()
    },
    {
      provider: 'SP Services',
      docType: 'Bill',
      amount: 'S$58.40',
      refNumber: '987654320',
      savedAt: new Date(Date.now() - 33 * 24 * 60 * 60 * 1000).toISOString()
    },
    {
      provider: 'SP Services',
      docType: 'Bill',
      amount: 'S$72.10',
      refNumber: '987654319',
      savedAt: new Date(Date.now() - 63 * 24 * 60 * 60 * 1000).toISOString()
    },
    {
      provider: 'StarHub',
      docType: 'Bill',
      amount: 'S$89.90',
      refNumber: '123456789',
      savedAt: new Date(Date.now() - 15 * 24 * 60 * 60 * 1000).toISOString()
    },
    {
      provider: 'StarHub',
      docType: 'Bill',
      amount: 'S$92.50',
      refNumber: '123456788',
      savedAt: new Date(Date.now() - 45 * 24 * 60 * 60 * 1000).toISOString()
    },
    {
      provider: 'NTUC FairPrice',
      docType: 'Shopping Receipt',
      amount: 'S$42.50',
      refNumber: '',
      savedAt: new Date(Date.now() - 7 * 24 * 60 * 60 * 1000).toISOString()
    },
    {
      provider: 'NTUC FairPrice',
      docType: 'Shopping Receipt',
      amount: 'S$38.20',
      refNumber: '',
      savedAt: new Date(Date.now() - 14 * 24 * 60 * 60 * 1000).toISOString()
    },
    {
      provider: 'PUB Water',
      docType: 'Bill',
      amount: 'S$28.60',
      refNumber: 'W123456',
      savedAt: new Date(Date.now() - 20 * 24 * 60 * 60 * 1000).toISOString()
    }
  ];
  
  localStorage.setItem('receiptHistory', JSON.stringify(sampleReceipts));
  showStatus('✅ Successfully seeded 8 sample receipts (3x SP Services, 2x StarHub, 2x NTUC, 1x PUB)');
});

document.getElementById('viewData').addEventListener('click', () => {
  const display = document.getElementById('dataDisplay');
  const data = {
    receiptHistory: JSON.parse(localStorage.getItem('receiptHistory') || '[]'),
    favoriteMerchants: JSON.parse(localStorage.getItem('favoriteMerchants') || '[]'),
    scanHistory: JSON.parse(localStorage.getItem('scanHistory') || '[]')
  };
  
  display.textContent = JSON.stringify(data, null, 2);
  display.classList.remove('hidden');
});

document.getElementById('clearData').addEventListener('click', () => {
  if (confirm('Clear all receipt history, favorites, and scan history?')) {
    localStorage.removeItem('receiptHistory');
    localStorage.removeItem('favoriteMerchants');
    localStorage.removeItem('scanHistory');
    sessionStorage.removeItem('favoriteMerchantContext');
    showStatus('✅ All data cleared');
    document.getElementById('dataDisplay').classList.add('hidden');
  }
});
</script>
</body>
</html>
